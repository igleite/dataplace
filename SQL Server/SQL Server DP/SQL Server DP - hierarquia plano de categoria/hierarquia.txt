WITH Hierarquia AS (
					SELECT PlanoCategProduto.CdCategoria,
                           PlanoCategProduto.Descricao,
                           PlanoCategProduto.Nivel,
                           PlanoCategProduto.CdCategoriaPai,
						   PlanoCategProduto.SqSort
                    FROM PlanoCategProduto
                    WHERE PlanoCategProduto.Nivel = 1

                    UNION ALL

                    SELECT p.CdCategoria,
                           p.Descricao,
                           p.Nivel,
                           p.CdCategoriaPai,
						   p.SqSort
                    FROM PlanoCategProduto p
                             INNER JOIN Hierarquia h ON p.CdCategoriaPai = h.CdCategoria
				   )
SELECT H.CdCategoria
     , REPLICATE('|---- ', H.Nivel - 1) + TRIM(H.Descricao) AS DescricaoHierarquica
FROM Hierarquia H
--WHERE H.CdCategoriaPai = '3641476'
ORDER BY h.SqSort, H.CdCategoria